{"code":"!function(e){var t={};function n(l){if(t[l])return t[l].exports;var s=t[l]={i:l,l:!1,exports:{}};return e[l].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=t,n.d=function(e,t,l){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(n.r(l),Object.defineProperty(l,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)n.d(l,s,function(t){return e[t]}.bind(null,s));return l},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=0)}([function(e,t,n){\"use strict\";n.r(t);var l=class{constructor(e){this.context=e}init(){this.oscillator=this.context.createOscillator(),this.gainNode=this.context.createGain(),this.oscillator.connect(this.gainNode),this.gainNode.connect(this.context.destination),this.oscillator.type=\"sine\"}play(e,t){this.init(),this.oscillator.frequency.value=e,this.gainNode.gain.setValueAtTime(1,this.context.currentTime),this.oscillator.start(t),this.stop(t)}stop(e){this.gainNode.gain.exponentialRampToValueAtTime(1e-5,e+1),this.oscillator.stop(e+1)}};console.log(l);const s=new(window.AudioContext||window.webkitAudioContext);let i,a,o,c=[],r=[];let u=[...document.getElementsByClassName(\"toggle\")],d=u.pop(),p=u,m=[...document.getElementsByClassName(\"row\")],v=document.getElementById(\"info\"),h=document.getElementById(\"add\"),g=[...document.getElementsByClassName(\"delete\")],f=[...document.getElementsByClassName(\"volume\")],y=[...document.getElementsByClassName(\"effect_gain\")],x=[...document.getElementsByClassName(\"melody\")],b=[...document.getElementsByClassName(\"interval\")],E=document.getElementsByClassName(\"panel\")[0];y.map(e=>e.addEventListener(\"input\",(function(){this.nextElementSibling.value=parseFloat(this.value).toFixed(2)}))),v.addEventListener(\"click\",(function(){console.log(r)})),h.addEventListener(\"click\",(function(){(()=>{const e=document.getElementsByClassName(\"row_last\")[0],t=document.getElementsByClassName(\"panel\")[0],n=parseFloat(getComputedStyle(t).height);e.insertAdjacentHTML(\"beforebegin\",'<div class=\"row\">\\n                    <div class=\"ceil\">\\n                        <button class=\"play toggle\">\\n                            <span class=\"btn-text\">Play</span>\\n                        </button>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <div class=\"select-wrapper\">\\n                            <select class=\"instrument\">\\n                                <option>Piano</option>\\n                                <option>Guitar</option>\\n                            </select>\\n                        </div>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"text\" class=\"melody\" readonly>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"text\" class=\"interval\" value=\"1000\" minlength=\"3\" maxlength=\"6\">\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <div class=\"select-wrapper\">\\n                            <select class=\"effect\">\\n                                <option>Пункт 1</option>\\n                                <option>Пункт 2</option>\\n                            </select>\\n                        </div>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"range\" name=\"effect_gain\" class=\"effect_gain\" min=\"0\" max=\"10\" step=\"0.01\"\\n                            value=\"5\">\\n                        <output>5.00</output>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"range\" name=\"volume\" class=\"volume\" min=\"0\" max=\"10\" step=\"0.01\" value=\"5\">\\n                        <output>5.00</output>\\n                    </div>\\n                    <button class=\"delete\"></button>\\n                </div>');const l=e.previousElementSibling;p=[...p,l.children[0].children[0]],x=[...x,l.children[2].children[0]],b=[...b,l.children[3].children[0]],f=[...f,l.children[6].children[0]],g=[...g,l.lastElementChild],m.splice(m.length-1,0,l),t.style.height=`${n+60}px`})()})),E.addEventListener(\"click\",e=>{const t=e.target,n=t.closest(\".play\"),l=t.closest(\".stop\"),u=t.closest(\".delete\");if(!(n||l||u))return;let d;for(let e=0;e<p.length;e++)if(n===p[e]||l===p[e]){d=e;break}if(n)(e=>{i=s.destination;const t={C:32.7,\"C#\":34.6,D:36.7,\"D#\":38.9,E:41.2,F:43.6,\"F#\":46.3,G:49,\"G#\":51.9,A:55,\"A#\":58.3,B:61.8},n=[\"C\",\"C#\",\"D\",\"D#\",\"E\",\"F\",\"F#\",\"G\",\"G#\",\"A\",\"A#\",\"B\"],l=2+Math.floor(5*Math.random());let u=[];for(let e=0;e<l;e++){const e=n[Math.floor(Math.random()*n.length)],t=3+Math.floor(6*Math.random()),l=\"#\"==e[1];u=l?[...u,e[0]+t+e[1]]:[...u,e+t]}const d=b[e].value;if(d<50)return void alert(\"Interval must be greater than 50\");x[e].value=u.join(\" \");const p=n=>{const l=n[0].toUpperCase(),c=parseInt(n[1]);let u=\"#\"==n[2]?t[l+\"#\"]*Math.pow(2,c-1):t[l]*Math.pow(2,c-1);const d=s.currentTime;o=s.createOscillator(),a=s.createGain(),o.connect(a),a.connect(i),r[e]||(r=[...r,a]),a.gain.exponentialRampToValueAtTime(1e-5,d+1),a.gain.value=f[e].value/10,o.type=\"sine\",o.frequency.value=u,o.start(d)},m=()=>{for(let t=0;t<u.length;t++){console.log(c[e]);const n=setTimeout(()=>{c[e]?p(u[t]):clearTimeout(n)},d*t)}};m();const v=setInterval(m,d*l);c[e]=v})(d),b[d].value>=50&&(n.classList.value=n.classList.value.replace(\"play\",\"stop\"),n.children[0].innerText=\"Stop\");else if(l)(e=>{clearInterval(c[e]),c[e]=0})(d),l.classList.value=l.classList.value.replace(\"stop\",\"play\"),l.children[0].innerText=\"Play\";else if(u){for(let e=0;e<g.length;e++)if(u===g[e]){d=e;break}(e=>{const t=document.getElementsByClassName(\"panel\")[0],n=parseFloat(getComputedStyle(t).height);t.style.height=`${n-60}px`,m[e+1].remove(),m.splice(e+1,1),g.splice(e,1)})(d)}}),E.addEventListener(\"input\",e=>{const t=e.target,n=t.closest(\".interval\"),l=t.closest(\".volume\");if(n){let e=n.value.replace(/[^\\d]/g,\"\");n.value=e}else t.nextElementSibling.value=parseFloat(t.value).toFixed(2);if(l&&a){let e;for(let t=0;t<f.length;t++)if(l===f[t]){e=t;break}r[e]&&(r[e].gain.value=l.value/10)}}),d.addEventListener(\"click\",(function(){\"play-all\"===this.classList[0]?(this.classList.value=this.classList.value.replace(\"play-all\",\"stop-all\"),this.children[0].innerText=\"S-All\",p.map(e=>{\"play\"===e.classList[0]&&e.click()})):(this.classList.value=this.classList.value.replace(\"stop-all\",\"play-all\"),this.children[0].innerText=\"All\",p.map(e=>{\"stop\"===e.classList[0]&&e.click()}))}))}]);","extractedComments":[]}