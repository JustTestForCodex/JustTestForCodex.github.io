{"code":"!function(e){var t={};function l(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.m=e,l.c=t,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var s in e)l.d(n,s,function(t){return e[t]}.bind(null,s));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,\"a\",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p=\"\",l(l.s=0)}([function(e,t,l){\"use strict\";l.r(t);var n=class{constructor(e){this.context=e,this.controctave={C:32.7,\"C#\":34.6,D:36.7,\"D#\":38.9,E:41.2,F:43.6,\"F#\":46.3,G:49,\"G#\":51.9,A:55,\"A#\":58.3,B:61.8},this.notes=[\"C\",\"C#\",\"D\",\"D#\",\"E\",\"F\",\"F#\",\"G\",\"G#\",\"A\",\"A#\",\"B\"],this.melody=[]}createMelody(e){for(let t=0;t<e;t++){const e=this.notes[Math.floor(Math.random()*this.notes.length)],t=3+Math.floor(6*Math.random()),l=\"#\"==e[1];this.melody=l?[...this.melody,e[0]+t+e[1]]:[...this.melody,e+t]}}init(){this.oscillator=this.context.createOscillator(),this.gainNode=this.context.createGain(),this.oscillator.connect(this.gainNode),this.gainNode.connect(this.context.destination),this.gainNode.gain.volume=this.volume,this.oscillator.type=\"sine\"}playNote(e){const t=e[0],l=parseInt(e[1]);let n=\"#\"==e[2]?this.controctave[t+\"#\"]*Math.pow(2,l-1):this.controctave[t]*Math.pow(2,l-1);this.init();const s=this.context.currentTime;console.log(this.volume),console.log(\"Я ЕБАЛ РОТ\"),this.oscillator.frequency.value=n,this.gainNode.gain.exponentialRampToValueAtTime(1e-5,s+1),console.log(this.gainNode.gain.volume),console.log(\"ХУЙНЯ ЕБАННАЯ\"),this.oscillator.start(s)}playMelody(e){for(let t=0;t<this.melody.length;t++){const l=setTimeout(()=>{this.continue?this.playNote(this.melody[t]):(this.stop(),clearTimeout(l))},e*t)}}play(e){this.continue=!0,this.playMelody(e),this.interval=setInterval(()=>this.playMelody(e),e*this.melody.length)}stop(){this.continue=!1,clearInterval(this.interval)}setVolume(e){this.volume=e}};const s=new(window.AudioContext||window.webkitAudioContext),o=[];let i=[...document.getElementsByClassName(\"toggle\")],a=i.pop(),c=i,r=[...document.getElementsByClassName(\"row\")],u=(document.getElementById(\"info\"),document.getElementById(\"add\")),d=[...document.getElementsByClassName(\"delete\")],p=[...document.getElementsByClassName(\"volume\")],m=[...document.getElementsByClassName(\"effect_gain\")],h=[...document.getElementsByClassName(\"melody\")],v=[...document.getElementsByClassName(\"interval\")],y=document.getElementsByClassName(\"panel\")[0];m.map(e=>e.addEventListener(\"input\",(function(){this.nextElementSibling.value=parseFloat(this.value).toFixed(2)}))),u.addEventListener(\"click\",(function(){(()=>{const e=document.getElementsByClassName(\"row_last\")[0],t=document.getElementsByClassName(\"panel\")[0],l=parseFloat(getComputedStyle(t).height);e.insertAdjacentHTML(\"beforebegin\",'<div class=\"row\">\\n                    <div class=\"ceil\">\\n                        <button class=\"play toggle\">\\n                            <span class=\"btn-text\">Play</span>\\n                        </button>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <div class=\"select-wrapper\">\\n                            <select class=\"instrument\">\\n                                <option>Piano</option>\\n                                <option>Guitar</option>\\n                            </select>\\n                        </div>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"text\" class=\"melody\" readonly>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"text\" class=\"interval\" value=\"1000\" minlength=\"3\" maxlength=\"6\">\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <div class=\"select-wrapper\">\\n                            <select class=\"effect\">\\n                                <option>Пункт 1</option>\\n                                <option>Пункт 2</option>\\n                            </select>\\n                        </div>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"range\" name=\"effect_gain\" class=\"effect_gain\" min=\"0\" max=\"10\" step=\"0.01\"\\n                            value=\"5\">\\n                        <output>5.00</output>\\n                    </div>\\n                    <div class=\"ceil\">\\n                        <input type=\"range\" name=\"volume\" class=\"volume\" min=\"0\" max=\"10\" step=\"0.01\" value=\"5\">\\n                        <output>5.00</output>\\n                    </div>\\n                    <button class=\"delete\"></button>\\n                </div>');const n=e.previousElementSibling;c=[...c,n.children[0].children[0]],h=[...h,n.children[2].children[0]],v=[...v,n.children[3].children[0]],p=[...p,n.children[6].children[0]],d=[...d,n.lastElementChild],r.splice(r.length-1,0,n),t.style.height=`${l+60}px`})()})),y.addEventListener(\"click\",e=>{const t=e.target,l=t.closest(\".play\"),i=t.closest(\".stop\"),a=t.closest(\".delete\");if(!(l||i||a))return;let u;for(let e=0;e<c.length;e++)if(l===c[e]||i===c[e]){u=e;break}if(l)(e=>{o[e]=new n(s);const t=o[e],l=2+Math.floor(5*Math.random());t.createMelody(l);const i=v[e].value;if(i<50)return void alert(\"Interval must be greater than 50\");h[e].value=t.melody.join(\" \");const a=p[e].value/10;t.setVolume(a),t.play(i)})(u),v[u].value>=50&&(l.classList.value=l.classList.value.replace(\"play\",\"stop\"),l.children[0].innerText=\"Stop\");else if(i)(e=>{o[e].stop(e)})(u),i.classList.value=i.classList.value.replace(\"stop\",\"play\"),i.children[0].innerText=\"Play\";else if(a){for(let e=0;e<d.length;e++)if(a===d[e]){u=e;break}(e=>{const t=document.getElementsByClassName(\"panel\")[0],l=parseFloat(getComputedStyle(t).height);t.style.height=`${l-60}px`,r[e+1].remove(),r.splice(e+1,1),d.splice(e,1)})(u)}}),y.addEventListener(\"input\",e=>{const t=e.target,l=t.closest(\".interval\"),n=t.closest(\".volume\");if(l){let e=l.value.replace(/[^\\d]/g,\"\");l.value=e}else t.nextElementSibling.value=parseFloat(t.value).toFixed(2);if(n){let e;for(let t=0;t<p.length;t++)if(n===p[t]){e=t;break}const t=o[e];console.log(e),console.log(t),t.setVolume(n.value/10)}}),a.addEventListener(\"click\",(function(){\"play-all\"===this.classList[0]?(this.classList.value=this.classList.value.replace(\"play-all\",\"stop-all\"),this.children[0].innerText=\"S-All\",c.map(e=>{\"play\"===e.classList[0]&&e.click()})):(this.classList.value=this.classList.value.replace(\"stop-all\",\"play-all\"),this.children[0].innerText=\"All\",c.map(e=>{\"stop\"===e.classList[0]&&e.click()}))}))}]);","extractedComments":[]}